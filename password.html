<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Accès protégé | Soulawesi Essential Oil</title>
        <!-- CSS -->
        <style>
            .password-container {
                max-width: 400px;
                margin: 5rem auto;
                padding: 2rem;
                background: #fff;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                font-family: var(--font);
            }
            .field {
                margin-bottom: 1rem;
            }
            .field label {
                display: block;
                margin-bottom: 0.5rem;
            }
            .field input {
                width: 100%;
                padding: 0.5rem;
                border: 1px solid #ccc;
                border-radius: 4px;
            }
            button {
                background: var(--primary);
                color: #fff;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 4px;
                cursor: pointer;
            }
            button:hover {
                opacity: 0.9;
            }
            .error-message {
                color: #e74c3c;
                margin-top: 1rem;
            }
        </style>
    </head>

    <body>

        <main class="password-container">
            <h1>Accès protégé</h1>
            <form id="password-form">
            <div class="field">
                <label for="password">Mot de passe :</label>
                <input type="password" id="password" required />
            </div>
            <button type="submit">Valider</button>
            </form>
            <p id="error" class="error-message"></p>
        </main>

        <!-- JS -->
        <SCRIPT>
            const PASSWORD = '14/04/81';
            const REDIRECT_URL = 'generateur-devis.html';
            const TOKEN_KEY     = 'authToken';
            const TOKEN_VALUE   = 'ok'; 

            window.addEventListener('DOMContentLoaded', () => {
                const token = localStorage.getItem(TOKEN_KEY);
                if (token === TOKEN_VALUE) {
                    // déjà authentifié : on redirige directement
                    window.location.href = REDIRECT_URL;
                }
            });

            document.getElementById('password-form').addEventListener('submit', e => {
            e.preventDefault();
            const input   = document.getElementById('password').value;
            const errorEl = document.getElementById('error');

            if (input === PASSWORD) {
                // mot de passe correct → on stocke le token
                localStorage.setItem(TOKEN_KEY, TOKEN_VALUE);
                // puis on redirige
                window.location.href = REDIRECT_URL;
            } else {
                errorEl.textContent = 'Mot de passe incorrect. Veuillez réessayer.';
            }
            });
        </SCRIPT>
    </body>
</html>